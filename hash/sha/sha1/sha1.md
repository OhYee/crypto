# SHA1

## 总览

|摘要长度|运算步骤数|基本逻辑函数数目|常数数目|
|:-----:|:------:|:------------:|:-----:|
|160bit |80      |4             |4      |

## 处理步骤

1. 首先确保输入分组长度$l$满足$l \equiv 448 \pmod {512}$
    - 补位采用1个1和多个0实现
2. 使用一个64位数据来记录数据长度，并将其补到数据后面，从而最终保证整个数据长度为512位的倍数($448+64=512$)
3. 初始化寄存器A、B、C、D、E
4. 将数据按照512位分组(64Byte)，每一组分为16个子分组，每个子分组32位(4Byte)
5. 对每个分组进行操作
    1. 共进行4轮操作，每轮包括20个步骤，共80步
    2. 首先先将寄存器内容存到新的寄存器组中
    3. 执行操作$A,B,C,D,E \leftarrow [(a<<5)+ft(B,C,D)+E+W_t+K_t],A,(B<<30),C,D$
        - 其中，$ft(B,C,D)$是逻辑函数 
            $ft(B,C,D)=\begin{cases}
                (B \cdot C) \vee (\sim B \cdot D)               & 0<=t<=19 \\
                B \oplus C \oplus D                             & 20<=t<=39 \\
                (B \cdot C) \vee (B \cdot D) \vee (C \cdot D)   & 40<=t<=59 \\
                B \oplus C \oplus D                             & 60<=t<=79 \\
            \end{cases} $
        - $W_t$是子明文分组
        - $K_t$是固定常数
            $k=\begin{cases}
                0x5A827999  &0<=t<=19\\
                0x6ED9EBA1  &20<=t<=39\\
                0x8F188CDC  &40<=t<=59\\
                0xCA62C1D6  &60<=t<=79\\
            \end{cases}$